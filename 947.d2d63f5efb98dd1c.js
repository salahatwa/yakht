"use strict";(self.webpackChunkFastkart_Admin_SSR=self.webpackChunkFastkart_Admin_SSR||[]).push([[947,255],{7947:(y,_,r)=>{r.r(_),r.d(_,{RoleModule:()=>q});var n=r(6814),h=r(186),u=r(6505),v=r(7582),m=r(8419),f=r(4685),e=r(9212),C=r(1427),g=r(7243),d=r(4274),c=r(9515);const k=()=>["/role/create"];function J(o,i){1&o&&(e.TgZ(0,"div",3)(1,"a",4),e._UZ(2,"i",5),e._uU(3),e.ALo(4,"translate"),e.qZA()()),2&o&&(e.xp6(1),e.Q6J("routerLink",e.DdM(4,k)),e.xp6(2),e.hij(" ",e.lcZ(4,2,"add_role")," "))}class A{constructor(i,t){this.store=i,this.router=t,this.tableConfig={columns:[{title:"No.",dataField:"no",type:"no"},{title:"name",dataField:"name",sortable:!0,sort_direction:"desc"},{title:"created_at",dataField:"created_at",type:"date",sortable:!0,sort_direction:"desc"}],rowActions:[{label:"Edit",actionToPerform:"edit",icon:"ri-pencil-line",permission:"role.edit"},{label:"Delete",actionToPerform:"delete",icon:"ri-delete-bin-line",permission:"role.destroy"}],data:[],total:0}}ngOnInit(){this.role$.subscribe(i=>{this.tableConfig.data=i?i?.data:[],this.tableConfig.total=i?i?.total:0})}onTableChange(i){this.store.dispatch(new f.ME(i))}onActionClicked(i){"edit"==i.actionToPerform?this.edit(i.data):"delete"==i.actionToPerform?this.delete(i.data):"deleteAll"==i.actionToPerform&&this.deleteAll(i.data)}edit(i){this.router.navigateByUrl(`/role/edit/${i.id}`)}delete(i){this.store.dispatch(new f.Fv(i.id))}deleteAll(i){this.store.dispatch(new f.VJ(i))}static#e=this.\u0275fac=function(t){return new(t||A)(e.Y36(h.yh),e.Y36(u.F0))};static#t=this.\u0275cmp=e.Xpm({type:A,selectors:[["app-role"]],decls:3,vars:5,consts:[[3,"gridClass","title"],["button","",4,"hasPermission"],[3,"tableConfig","hasCheckbox","tableChanged","rowClicked","action"],["button",""],[1,"align-items-center","btn","btn-theme","d-flex",3,"routerLink"],[1,"ri-add-line"]],template:function(t,s){1&t&&(e.TgZ(0,"app-page-wrapper",0),e.YNc(1,J,5,5,"div",1),e.TgZ(2,"app-table",2),e.NdJ("tableChanged",function(a){return s.onTableChange(a)})("rowClicked",function(a){return s.edit(a)})("action",function(a){return s.onActionClicked(a)}),e.qZA()()),2&t&&(e.Q6J("gridClass","col-sm-12")("title","roles"),e.xp6(1),e.Q6J("hasPermission","role.create"),e.xp6(1),e.Q6J("tableConfig",s.tableConfig)("hasCheckbox",!0))},dependencies:[u.rH,C.a,g.t,d.A,c.X$]})}(0,v.gn)([(0,h.Ph)(m.s.role)],A.prototype,"role$",void 0);var p=r(6223),R=r(8645),E=r(2096),U=r(4664),O=r(1631),M=r(9773),L=r(3092),I=r(2879);function Q(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"li")(2,"div",5)(3,"input",8),e.NdJ("change",function(l){const x=e.CHM(t).$implicit,P=e.oxw().$implicit,F=e.oxw();return e.KtG("index"===x.name&&x.isChecked?F.checkIndex(l,P):F.onPermissionChecked(l,P))}),e.qZA(),e.TgZ(4,"label",7),e._uU(5),e.ALo(6,"titlecase"),e.qZA()()(),e.BQk()}if(2&o){const t=i.$implicit,s=e.oxw(2);e.xp6(3),e.s9C("id",t.permission_id),e.Q6J("name",t.name)("checked",!!(null!=s.selectedPermission&&s.selectedPermission.includes(+t.permission_id)||t.isChecked))("value",t.permission_id),e.xp6(1),e.s9C("for",t.permission_id),e.xp6(1),e.hij(" ",e.lcZ(6,6,t.name)," ")}}function $(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",4)(2,"ul")(3,"li"),e._uU(4),e.ALo(5,"titlecase"),e.qZA(),e.TgZ(6,"li")(7,"div",5)(8,"input",6),e.NdJ("change",function(l){const x=e.CHM(t).$implicit,P=e.oxw();return e.KtG(P.checkUncheckAll(l,x))}),e.qZA(),e.TgZ(9,"label",7),e._uU(10),e.qZA()()(),e.YNc(11,Q,7,8,"ng-container",3),e.qZA()(),e.BQk()}if(2&o){const t=i.$implicit;e.xp6(4),e.hij("",e.lcZ(5,6,null==t?null:t.name.replace("_"," "))," "),e.xp6(4),e.MGl("id","role-",t.id,""),e.Q6J("checked",t.isChecked),e.xp6(1),e.MGl("for","role-",t.id,""),e.xp6(1),e.Oqu("All"),e.xp6(1),e.Q6J("ngForOf",t.module_permissions)}}class T{constructor(i){this.store=i,this.selectedPermission=[],this.setPermissions=new e.vpe,this.store.dispatch(new f.Wl)}ngOnChanges(i){let t=i.selectedPermission?.currentValue;this.modules$.subscribe(s=>{s?.map(l=>{l.module_permissions.map(a=>{a.isChecked=t.includes(a.id)})}),s?.filter(l=>{this.updateCheckBoxStatus(l)})})}checkUncheckAll(i,t){t.module_permissions.forEach(s=>{s.isChecked=i.target.checked,this.addPermission(i.target.checked,s?.id,t)})}checkIndex(i,t){t.module_permissions.forEach(s=>{s.isChecked=!1,this.addPermission(!1,s?.id,t)})}onPermissionChecked(i,t){t.module_permissions.forEach(s=>{s.isChecked=!1,"index"==s.name&&(s.isChecked=!s.isChecked,this.addPermission(!0,+s.id,t)),this.addPermission(i.target?.checked,+i?.target?.value,t)})}addPermission(i,t,s){const l=this.selectedPermission.indexOf(Number(t));i?-1==l&&this.selectedPermission.push(Number(t)):this.selectedPermission=this.selectedPermission.filter(a=>a!=Number(t)),this.setPermissions.emit(this.selectedPermission),this.updateCheckBoxStatus(s)}updateCheckBoxStatus(i){let t=0;i.module_permissions.filter(s=>{this.selectedPermission.includes(s.id)&&t++,i.isChecked=i.module_permissions.length<=t})}static#e=this.\u0275fac=function(t){return new(t||T)(e.Y36(h.yh))};static#t=this.\u0275cmp=e.Xpm({type:T,selectors:[["app-permissions"]],inputs:{selectedPermission:"selectedPermission"},outputs:{setPermissions:"setPermissions"},features:[e.TTD],decls:5,vars:3,consts:[[1,"row","g-sm-4","g-2"],[1,"col-xl-12"],[1,"row","roles-form"],[4,"ngFor","ngForOf"],[1,"col-12"],[1,"form-check","form-switch"],["type","checkbox",1,"checkbox_animated","form-check-input","checkall",3,"id","checked","change"],[1,"form-check-label","m-0","form-label",3,"for"],["type","checkbox",1,"checkbox_animated","form-check-input","check-it",3,"name","id","checked","value","change"]],template:function(t,s){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e.YNc(3,$,12,8,"ng-container",3),e.ALo(4,"async"),e.qZA()()()),2&t&&(e.xp6(3),e.Q6J("ngForOf",e.lcZ(4,1,s.modules$)))},dependencies:[n.sg,n.Ov,n.rS]})}function B(o,i){1&o&&(e.TgZ(0,"div",11),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"name_is_required")," "))}function N(o,i){1&o&&(e.TgZ(0,"div",12),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"permissions_is_required")," "))}(0,v.gn)([(0,h.Ph)(m.s.roleModules)],T.prototype,"modules$",void 0);let b=(()=>{class o{constructor(t,s,l,a){this.store=t,this.route=s,this.router=l,this.formBuilder=a,this.permissions=[],this.destroy$=new R.x,this.form=this.formBuilder.group({name:new p.NI("",[p.kI.required]),permissions:new p.NI("",[p.kI.required])})}get permissionControl(){return this.form.get("permissions")}ngOnInit(){this.route.params.pipe((0,U.w)(t=>t.id?this.store.dispatch(new f.tU(t.id)).pipe((0,O.z)(()=>this.store.select(m.s.selectedRole))):(0,E.of)()),(0,M.R)(this.destroy$)).subscribe(t=>{this.id=t?.id;let s=t?.permissions.map(l=>l?.id);this.permissions=s,this.form.patchValue({name:t?.name,permissions:s})})}setPermissions(t){Array.isArray(t)&&this.form.controls.permissions.setValue(t)}submit(){this.form.markAllAsTouched();let t=new f.uQ(this.form.value);"edit"==this.type&&this.id&&(t=new f.$(this.form.value,this.id)),this.form.valid&&this.store.dispatch(t).subscribe({complete:()=>{this.router.navigateByUrl("/role")}})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static#e=this.\u0275fac=function(s){return new(s||o)(e.Y36(h.yh),e.Y36(u.gz),e.Y36(u.F0),e.Y36(p.qu))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-form-role"]],inputs:{type:"type"},decls:17,vars:17,consts:[[1,"theme-form","theme-form-2","mega-form",3,"formGroup","ngSubmit"],[1,"row"],[3,"label","for","required"],["type","text","name","name","formControlName","name",1,"form-control",3,"placeholder"],["class","invalid-feedback",4,"ngIf"],[1,"mb-3","d-flex"],[1,"form-label-title"],[1,"theme-color","ms-2","required-dot"],["class","mt-0 ms-4 invalid-feedback",4,"ngIf"],[3,"selectedPermission","setPermissions"],[3,"id"],[1,"invalid-feedback"],[1,"mt-0","ms-4","invalid-feedback"]],template:function(s,l){1&s&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return l.submit()}),e.TgZ(1,"div",1)(2,"app-form-fields",2),e._UZ(3,"input",3),e.ALo(4,"translate"),e.YNc(5,B,3,3,"div",4),e.qZA(),e.TgZ(6,"div",5)(7,"h4",6),e._uU(8),e.ALo(9,"translate"),e.TgZ(10,"span",7),e._uU(11,"*"),e.qZA()(),e.YNc(12,N,3,3,"div",8),e.qZA(),e.TgZ(13,"app-permissions",9),e.NdJ("setPermissions",function(x){return l.setPermissions(x)}),e.qZA()(),e.TgZ(14,"app-button",10),e._uU(15),e.ALo(16,"translate"),e.qZA()()),2&s&&(e.Q6J("formGroup",l.form),e.xp6(2),e.Q6J("label","name")("for","name")("required",!0),e.xp6(1),e.s9C("placeholder",e.lcZ(4,11,"enter_name")),e.xp6(2),e.Q6J("ngIf",l.form.controls.name.touched&&(null==l.form.controls.name.errors?null:l.form.controls.name.errors.required)),e.xp6(3),e.hij("",e.lcZ(9,13,"permissions")," "),e.xp6(4),e.Q6J("ngIf",l.form.controls.permissions.touched&&l.form.controls.permissions.invalid),e.xp6(1),e.Q6J("selectedPermission",l.permissions),e.xp6(1),e.Q6J("id","role_btn"),e.xp6(1),e.Oqu(e.lcZ(16,15,"save")))},dependencies:[n.O5,p._Y,p.Fj,p.JJ,p.JL,p.sg,p.u,L.L,I.r,T,c.X$]})}return o})(),D=(()=>{class o{static#e=this.\u0275fac=function(s){return new(s||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-create-role"]],decls:2,vars:3,consts:[[3,"gridClass","title"],[3,"type"]],template:function(s,l){1&s&&(e.TgZ(0,"app-page-wrapper",0),e._UZ(1,"app-form-role",1),e.qZA()),2&s&&(e.Q6J("gridClass","col-xxl-8 col-lg-10 m-auto")("title","create_role"),e.xp6(1),e.Q6J("type","create"))},dependencies:[g.t,b]})}return o})(),S=(()=>{class o{static#e=this.\u0275fac=function(s){return new(s||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-edit-role"]],decls:2,vars:3,consts:[[3,"gridClass","title"],[3,"type"]],template:function(s,l){1&s&&(e.TgZ(0,"app-page-wrapper",0),e._UZ(1,"app-form-role",1),e.qZA()),2&s&&(e.Q6J("gridClass","col-xxl-8 col-lg-10 m-auto")("title","edit_role"),e.xp6(1),e.Q6J("type","edit"))},dependencies:[g.t,b]})}return o})();var Z=r(5419);const w=[{path:"",component:A,canActivate:[Z.n],data:{permission:"role.index"}},{path:"create",component:D,canActivate:[Z.n],data:{permission:["role.index","role.create"]}},{path:"edit/:id",component:S,canActivate:[Z.n],data:{permission:["role.index","role.edit"]}}];let Y=(()=>{class o{static#e=this.\u0275fac=function(s){return new(s||o)};static#t=this.\u0275mod=e.oAB({type:o});static#s=this.\u0275inj=e.cJS({imports:[u.Bz.forChild(w),u.Bz]})}return o})();var j=r(6208);let q=(()=>{class o{static#e=this.\u0275fac=function(s){return new(s||o)};static#t=this.\u0275mod=e.oAB({type:o});static#s=this.\u0275inj=e.cJS({imports:[n.ez,Y,j.m,h.$l.forFeature([m.s])]})}return o})()},5419:(y,_,r)=>{r.d(_,{n:()=>v});var n=r(9212),h=r(186),u=r(6505);let v=(()=>{class m{constructor(e,C){this.store=e,this.router=C}canActivate(e,C){const g=this.store.selectSnapshot(c=>c.account).permissions?.map(c=>c?.name),d=e.data?.permission;return!!(!d||!Array.isArray(d)&&g?.includes(d)||Array.isArray(d)&&d?.length&&d.every(c=>g?.includes(c)))||(this.router.navigate(["/error/403"]),!1)}static#e=this.\u0275fac=function(C){return new(C||m)(n.LFG(h.yh),n.LFG(u.F0))};static#t=this.\u0275prov=n.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"})}return m})()},3092:(y,_,r)=>{r.d(_,{L:()=>f});var n=r(9212),h=r(6814),u=r(9515);function v(e,C){1&e&&(n.TgZ(0,"span",1),n._uU(1,"*"),n.qZA())}const m=["*"];let f=(()=>{class e{constructor(){this.class="mb-4 row align-items-center g-2",this.labelClass="form-label-title col-sm-2 mb-0",this.gridClass="col-sm-10"}static#e=this.\u0275fac=function(d){return new(d||e)};static#t=this.\u0275cmp=n.Xpm({type:e,selectors:[["app-form-fields"]],inputs:{class:"class",label:"label",labelClass:"labelClass",gridClass:"gridClass",for:"for",required:"required"},ngContentSelectors:m,decls:7,vars:11,consts:[["class","theme-color ms-2 required-dot",4,"ngIf"],[1,"theme-color","ms-2","required-dot"]],template:function(d,c){1&d&&(n.F$t(),n.TgZ(0,"div")(1,"label"),n._uU(2),n.ALo(3,"translate"),n.YNc(4,v,2,0,"span",0),n.qZA(),n.TgZ(5,"div"),n.Hsn(6),n.qZA()()),2&d&&(n.Tol(c.class),n.xp6(1),n.Tol(c.labelClass),n.uIk("for",c.for),n.xp6(1),n.hij(" ",n.lcZ(3,9,c.label),""),n.xp6(2),n.Q6J("ngIf",c.required),n.xp6(1),n.Tol(c.gridClass))},dependencies:[h.O5,u.X$]})}return e})()}}]);